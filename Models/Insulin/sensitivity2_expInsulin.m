function [dS]=sensitivity2_expInsulin(x,theta,u,Jf,Sf)
m=6;
n=3;
%dJf_x
dJf_x(:,:,1)=[...
0,0,0;...
0,0,0;...
0,0,0];
dJf_x(:,:,2)=[...
0,0,0;...
0,0,0;...
0,0,-exp(theta(5))];
dJf_x(:,:,3)=[...
0,0,0;...
0,0,0;...
0,-exp(theta(5)),0];
%dJf_theta
dJf_theta(:,:,1)=[...
-exp(theta(1)),0,0;...
exp(theta(1)),0,0;...
0,0,0];
dJf_theta(:,:,2)=[...
-u(1)*exp(theta(2)),0,0;...
u(1)*exp(theta(2)),0,0;...
0,0,0];
dJf_theta(:,:,3)=[...
-exp(theta(3)),-exp(theta(3)),0;...
0,0,0;...
0,0,0];
dJf_theta(:,:,4)=[...
0,0,0;...
0,-exp(theta(4)),0;...
0,0,0];
dJf_theta(:,:,5)=[...
0,0,0;...
0,0,0;...
0,-(-10.0+x(3))*exp(theta(5)),-exp(theta(5))*x(2)];
dJf_theta(:,:,6)=[...
0,0,0;...
0,0,0;...
0,0,-exp(theta(6))];
%dKf_theta
dKf_theta(:,:,1)=[...
-x(1)*exp(theta(1)),0,0,0,0,0;...
x(1)*exp(theta(1)),0,0,0,0,0;...
0,0,0,0,0,0];
dKf_theta(:,:,2)=[...
0,-u(1)*exp(theta(2))*x(1),0,0,0,0;...
0,u(1)*exp(theta(2))*x(1),0,0,0,0;...
0,0,0,0,0,0];
dKf_theta(:,:,3)=[...
0,0,-(-10.0+x(2)+x(1))*exp(theta(3)),0,0,0;...
0,0,0,0,0,0;...
0,0,0,0,0,0];
dKf_theta(:,:,4)=[...
0,0,0,0,0,0;...
0,0,0,-exp(theta(4))*x(2),0,0;...
0,0,0,0,0,0];
dKf_theta(:,:,5)=[...
0,0,0,0,0,0;...
0,0,0,0,0,0;...
0,0,0,0,-(-10.0+x(3))*exp(theta(5))*x(2),0];
dKf_theta(:,:,6)=[...
0,0,0,0,0,0;...
0,0,0,0,0,0;...
0,0,0,0,0,-exp(theta(6))*x(3)];
 A=zeros(n,n,m);
 for k=1:m
  for l=1:n
   A(:,l,k)=dJf_x(:,:,l)*Sf(:,k)+dJf_theta(:,l,k);
  end%for
 end%for
 B=zeros(n,m,m);
 for k=1:m
  for i=1:m
   B(:,i,k)=dJf_theta(:,:,i)*Sf(:,k);
  end%for
 end%for
 for k=1:m
  dS(:,:,k)=-Jf\(A(:,:,k)*Sf+B(:,:,k)+dKf_theta(:,:,k));
 end%for
end%function
